!function(global){var _u=void 0,_n=null,o={},ajax=function(){var ajax=function(){var n=!1,t=!1,e="Msxml2.XMLHTTP",o=[e+".6.0",e+".3.0","Microsoft.XMLHTTP"];try{new XDomainRequest,n=!0,t=!0}catch(u){try{new ActiveXObject(e),n=!0}catch(r){}}var i=function(){var e;if(n)for(var u=0;u<o.length;u++)try{new ActiveXObject(o[u]),e=function(){return new ActiveXObject(o[u])};break}catch(r){}return e==_u&&(e=function(){return new XMLHttpRequest}),t?function(n){if(1==n){var t=new XDomainRequest;return t.ie=0,t}return e()}:e}(),c=function(n,t){"POST"==n&&t.setRequestHeader("Content-Type","application/x-www-form-urlencoded")},a=function(n,t){if(t)for(var e in t)n.setRequestHeader(e,t[e])};return function(n,t,e,o,u){n=(n+"").toUpperCase(),t+=(-1==t.indexOf("?")?"?":"&")+(new Date).getTime();var r="";if("string"!=typeof e)for(var s in e)r+="&"+s+"="+encodeURIComponent(e[s]);else r=e;if("GET"==n&&(t+=r,r=null),u==_u){var l=i();return l.open(n,t,!1),c(n,l),a(l,o),l.send(r),l.responseText}var l=i(/^https?:\/\//i.test(t)?1:0);return 0==l.ie?(l.onprogress=function(){},l.onload=function(){u(l.status,l.responseText)},l.open(n,t)):(l.onreadystatechange=function(){4==l.readyState&&u(l.status,l.responseText)},l.open(n,t,!0)),c(n,l),a(l,o),l.send(r),l}}();return ajax.json=function(v){return eval("["+v+"]")[0]},ajax}();o.reception=function(n){if(n==_u||n==_n)return null;var t=ajax.json,e={},o="";return e.uuid=function(){return o},e.connect=function(e){return""!=o?void e(""):void ajax("GET",n+"/create","",null,function(n,u){u=t(u),o=u.uuid,e(o)})},e.close=function(e){return""==o?void e(!1):void ajax("GET",n+"/clear/"+o,"",null,function(n,u){u=t(u),o="",e(u.result)})},e.reconnect=function(n){n!=_u&&n!=_n||(n=""),o=n},e.size=function(e){return""==o?void e(-1):void ajax("GET",n+"/size/"+o,"",null,function(n,o){o=t(o),e(o.size)})},e.send=function(e,u){return""==o?void u(!1):void ajax("POST",n+"/send/"+o,e,null,function(n,e){e=t(e),u(e.result)})},e.connectSend=function(n,t,o){e.reconnect(n),e.send(t,o)},e};var Comet=function(n,t,e,o){var u=0,r=!1,i=null,c={};c.close=function(){null!=i&&(i.abort(),i=null),r=!0,u=0},c.readyState=function(){return u};var a=function(n){var t,e,o,u={};for(e=0;-1!=(o=n.indexOf(": ",e));){if(t=n.substring(e,o),e=o+2,o=n.indexOf("\r\n",e),-1==o){u[t]=n.substring(e);break}u[t]=n.substring(e,o),e=o+2}return u},s=function(){r||(i=ajax("GET",n+"/"+t,"",null,function(n,t){return 200!=n?(close(),void o({state:n,result:t})):r?void(u=0):(u=1,e(a(t)),void setTimeout(s,0))}))};s()};o.sse=function(n,t){if(n==_u||n==_n||t==_u||t==_n)return null;var e={},o=t,u=null;return e.connect=function(t){null!=u&&e.close();var r=function(n){n.data!=_u&&n.data!=_n&&""!=n.data&&t(!0,n)},i=function(n){e.isConnect()||e.close(),t(!1,n)};window.EventSource!=_u?(u=new EventSource(n+"/"+document.domain+"/"+o+"/"+window.location.protocol,{withCredentials:!0}),u.onmessage=r,u.onerror=i):u=Comet(n,o,r,i)},e.close=function(){if(null!=u){try{u.close()}catch(n){}u=null}},e.uuid=function(){return o},e.isConnect=function(){return null==u?!1:1==u.readyState},e},global.HttpPush=o}(window);