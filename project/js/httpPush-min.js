!function(global){var _u=void 0,_n=null,o={},ajax=function(){var e=function(){return(new Date).getTime()},t={ajax:function(){var t=void 0,r=!1,u=!1,o="Msxml2.XMLHTTP",i=[o+".6.0",o+".3.0","Microsoft.XMLHTTP"];try{new XDomainRequest,r=!0,u=!0}catch(a){try{new ActiveXObject(o),r=!0}catch(c){}}var l=function(){var e;if(r)for(var o=0;o<n.length;o++)try{new ActiveXObject(i[o]),e=function(){return new ActiveXObject(i[o])};break}catch(a){}return e==t&&(e=function(){return new XMLHttpRequest}),u?function(n){if(1==n){var t=new XDomainRequest;return t.ie=0,t}return e()}:e}(),s=function(n,e){"POST"!=n&&"DELETE"!=n||e.setRequestHeader("Content-type","application/x-www-form-urlencoded")},d=function(n,e){if(e)for(var t in e)n.setRequestHeader(t,e[t])};return function(n,r,u,o,i){n=(n+"").toUpperCase(),r=r+(-1==r.indexOf("?")?"?":"&")+e();var a="";if("string"!=typeof u)for(var c in u)a+="&"+c+"="+encodeURIComponent(u[c]);else a=u;if("GET"==n&&(r+=a,a=null),i==t){var f=l();return f.open(n,r,!1),s(n,f),d(f,o),f.send(a),f.responseText}var f=l(/^https?:\/\//i.test(r)?1:0);0==f.ie?(f.onprogress=function(){},f.onload=function(){i(f.status,f.responseText)},f.open(n,r)):(f.open(n,r,!0),f.onreadystatechange=function(){4==f.readyState&&i(f.status,f.responseText)}),s(n,f),d(f,o),f.send(a)}}()};return t.ajax}();o.reception=function(domain){if(domain==_u||domain==_n)return null;var ret={},uuid="";return ret.uuid=function(){return uuid},ret.connect=function(call){return""!=uuid?void call(""):void ajax("GET",domain+"/create","",null,function(state,res){res=eval("["+res+"]")[0],uuid=res.uuid,call(uuid)})},ret.close=function(call){return""==uuid?void call(!1):void ajax("GET",domain+"/clear/"+uuid,"",null,function(state,res){res=eval("["+res+"]")[0],uuid="",call(res.result)})},ret.reconnect=function(n){n!=_u&&n!=_n||(n=""),uuid=n},ret.size=function(call){return""==uuid?void call(-1):void ajax("GET",domain+"/size/"+uuid,"",null,function(state,res){res=eval("["+res+"]")[0],call(res.size)})},ret.send=function(data,call){return""==uuid?void call(!1):void ajax("POST",domain+"/send/"+uuid,data,null,function(state,res){res=eval("["+res+"]")[0],call(res.result)})},ret.connectSend=function(n,e,t){ret.reconnect(n),ret.send(e,t)},ret},o.sse=function(n,e){if(n==_u||n==_n||e==_u||e==_n)return null;var t={},r=e,u=null;return t.connect=function(e){null!=u&&t.close(),u=new EventSource(n+"/"+document.domain+"/"+r+"/"+window.location.protocol,{withCredentials:!0}),u.onmessage=function(n){n.data!=_u&&n.data!=_n&&""!=n.data&&e(!0,n)},u.onerror=function(n){t.isConnect()||t.close(),e(!1,n)}},t.close=function(){if(null!=u){try{u.close()}catch(n){}u=null}},t.uuid=function(){return r},t.isConnect=function(){return null==u?!1:1==u.readyState},t},global.HttpPush=o}(window);